<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Omni Logic Elite - V37</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pyidaungsu:wght@400;700&display=swap');
        body { font-family: 'Pyidaungsu', sans-serif; background-color: #010816; color: white; overflow: hidden; touch-action: manipulation; }
        .fixed-header { position: fixed; top: 0; left: 0; right: 0; z-index: 100; background: #010816; padding: 10px; border-bottom: 2px solid #00cfd5; }
        .main-scroll { margin-top: 340px; height: calc(100vh - 340px); overflow-y: auto; padding: 10px; }
        .box-p { border: 4px solid #ff4136; color: #ff4136; border-radius: 50%; width: 55px; height: 55px; font-size: 24px; display: flex; align-items: center; justify-content: center; background: white; font-weight: 900; margin: 0 auto; }
        .box-e { border: 4px solid #b10dc9; color: #b10dc9; border-radius: 12px; width: 55px; height: 55px; font-size: 24px; display: flex; align-items: center; justify-content: center; background: white; font-weight: 900; position: relative; margin: 0 auto; }
        .box-s { border: 4px solid #2ecc40; color: #2ecc40; border-radius: 8px; width: 50px; height: 50px; font-size: 24px; display: flex; align-items: center; justify-content: center; transform: rotate(45deg); background: white; font-weight: 900; position: relative; margin: 0 auto; }
        .box-s span { transform: rotate(-45deg); }
        .roll-card { flex-shrink: 0; width: 280px; background: #001d3d; border-radius: 20px; padding: 12px; border: 1px solid #00cfd5; margin-right: 12px; }
        .g-num { background: #ffdc00; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 50%; border: 2px solid #000; color: black; font-weight: 900; }
        .btn-submit { background: #00cfd5; color: black; font-weight: 900; border-radius: 12px; width: 80px; height: 60px; active: scale(0.95); }
    </style>
</head>
<body>

    <div class="fixed-header space-y-3">
        <div class="flex justify-between items-center px-1">
            <h1 class="text-xl font-black italic text-cyan-500">OMNI V37</h1>
            <div class="flex items-center gap-2 bg-white/5 px-3 py-1 rounded-full border border-white/10">
                <span id="plan-status" class="text-[9px] font-black text-cyan-400 uppercase italic">Elite Active</span>
            </div>
        </div>

        <div class="bg-[#001d3d] p-3 grid grid-cols-3 gap-1 rounded-[25px] border-b-4 border-cyan-500 shadow-lg">
            <div class="text-center"><p class="text-[8px] font-bold text-gray-500 mb-1 uppercase">P-Logic</p><div class="box-p"><span id="pred-p">-</span></div></div>
            <div class="text-center"><p class="text-[8px] font-bold text-gray-500 mb-1 uppercase">E-Logic</p><div class="box-e"><span id="pred-e">-</span></div></div>
            <div class="text-center"><p class="text-[8px] font-bold text-gray-500 mb-1 uppercase">S-Logic</p><div class="box-s"><span id="pred-s">-</span></div></div>
        </div>

        <div class="bg-[#001d3d] p-3 rounded-[2rem] flex items-center gap-3 border border-white/5 shadow-xl">
            <div id="highlight-g" class="text-5xl font-black text-cyan-400 w-16 text-center">-</div>
            <input type="tel" id="digit-input" class="flex-1 rounded-xl text-center text-4xl font-black h-[60px] border-4 border-cyan-500 text-black outline-none" placeholder="?" maxlength="1">
            <button id="submit-btn" onclick="submitDigit()" class="btn-submit uppercase">Enter</button>
        </div>

        <div id="pattern-section" class="px-1">
            <div class="bg-black/40 p-2 rounded-xl border-l-4 border-yellow-500 min-h-[45px] flex flex-col justify-center">
                <p class="text-[8px] text-yellow-500 font-black uppercase italic">Elite Trend Feed (PHI)</p>
                <div id="pattern-display" class="text-sm font-black text-white italic">ANALYZING...</div>
            </div>
        </div>
    </div>

    <div class="main-scroll">
        <div id="history-container" class="flex overflow-x-auto gap-3 pb-4"></div>
        
        <div class="flex gap-2 mt-4 px-1">
            <button onclick="copyLogs()" class="flex-1 bg-white/5 py-4 rounded-xl font-black text-[10px] uppercase border border-white/10 text-gray-400">ðŸ“‹ Copy Logs</button>
            <button onclick="fullReset()" class="flex-1 bg-red-900/10 py-4 text-red-500 font-black rounded-xl text-[10px] uppercase border border-red-900/30">System Reset</button>
        </div>
    </div>

    <script>
        // State Management
        let history = []; 
        let roll = 1, stage = 1;
        let pNext = "-", eNext = "-", sNext = "-";
        
        const inputField = document.getElementById('digit-input');

        // Logic Functions
        function submitDigit() {
            const val = parseInt(inputField.value);
            if (isNaN(val)) {
                alert("á€‚á€á€”á€ºá€¸á€‘á€Šá€·á€ºá€•á€«");
                return;
            }
            
            const grp = val >= 5 ? 'B' : 'S';
            
            // Record Current Prediction Accuracy before moving to next
            const entry = {
                val: val,
                grp: grp,
                roll: roll,
                stage: stage,
                p: pNext, pOk: pNext === grp,
                e: eNext, eOk: eNext === grp,
                s: sNext, sOk: sNext === grp
            };

            history.push(entry);

            // Update Roll/Stage
            if (stage === 10) {
                roll++;
                stage = 1;
            } else {
                stage++;
            }

            // Sync PHI & Predictions
            updatePredictions(val);
            syncPHI();
            renderUI();
            
            // Reset Input
            inputField.value = "";
            inputField.focus();
            
            // Save to Local
            localStorage.setItem('OMNI_V37_DB', JSON.stringify({ history, roll, stage }));
        }

        function updatePredictions(last) {
            // P Logic: Flip last digit parity
            pNext = (last % 2 === 0) ? 'S' : 'B';

            // E Logic: Sum of last 3
            if (history.length >= 3) {
                const s3 = history.slice(-3).reduce((a, b) => a + b.val, 0);
                eNext = (s3 % 2 === 0) ? 'S' : 'B';
            }

            // S Logic: Advanced Digit Sum (last 5)
            if (history.length >= 5) {
                let dSum = history.slice(-5).reduce((a, b) => a + b.val, 0);
                while (dSum >= 10) {
                    dSum = dSum.toString().split('').map(Number).reduce((a, b) => a + b, 0);
                }
                sNext = (dSum % 2 !== 0) ? 'B' : 'S';
            }

            // Update UI Displays
            document.getElementById('pred-p').innerText = pNext;
            document.getElementById('pred-e').innerText = eNext;
            document.getElementById('pred-s').innerText = sNext;
            document.getElementById('highlight-g').innerText = last;
        }

        function syncPHI() {
            const seq = history.map(h => h.grp).join('');
            const streak = seq.match(/(B{4,}|S{4,})$/);
            const alt = seq.match(/((SB){3,}|(BS){3,})$/);
            const display = document.getElementById('pattern-display');

            if (streak) {
                const type = streak[0][0] === 'B' ? "á€¡á€€á€¼á€®á€¸á€†á€€á€º" : "á€¡á€žá€±á€¸á€†á€€á€º";
                display.innerText = `âš ï¸ ${type} : ${streak[0].length} á€€á€¼á€­á€™á€º (WARNING)`;
                display.className = "text-sm font-black text-red-500 animate-pulse italic";
            } else if (alt) {
                display.innerText = `ðŸ”„ á€á€…á€ºá€œá€¾á€Šá€·á€ºá€…á€® : ${alt[0].length} á€€á€¼á€­á€™á€º (DETECTED)`;
                display.className = "text-sm font-black text-purple-400 italic";
            } else {
                display.innerText = "MARKET STABLE";
                display.className = "text-[10px] font-bold text-gray-500 italic uppercase";
            }
        }

        function renderUI() {
            const container = document.getElementById('history-container');
            const groups = history.reduce((acc, cur) => {
                if (!acc[cur.roll]) acc[cur.roll] = [];
                acc[cur.roll].push(cur);
                return acc;
            }, {});

            container.innerHTML = Object.keys(groups).map(rNum => `
                <div class="roll-card shadow-2xl">
                    <div class="text-[10px] font-black text-cyan-500 mb-2 border-b border-white/10 pb-1 flex justify-between uppercase italic">
                        <span>Roll ${rNum}</span>
                        <span class="text-gray-600">P | E | S</span>
                    </div>
                    ${groups[rNum].map(i => `
                        <div class="flex items-center justify-between py-2 border-b border-white/5 last:border-0">
                            <span class="text-[9px] text-gray-500 w-3 font-bold">${i.stage}</span>
                            <div class="flex gap-4 flex-1 justify-center">
                                <span class="text-[11px] ${i.pOk ? 'text-green-500' : 'text-red-500'} font-black">${i.p}${i.pOk ? 'âœ“' : 'âœ•'}</span>
                                <span class="text-[11px] ${i.eOk ? 'text-green-500' : 'text-red-500'} font-black">${i.e}${i.eOk ? 'âœ“' : 'âœ•'}</span>
                                <span class="text-[11px] ${i.sOk ? 'text-green-500' : 'text-red-500'} font-black">${i.s}${i.sOk ? 'âœ“' : 'âœ•'}</span>
                            </div>
                            <div class="g-num">${i.val}</div>
                        </div>
                    `).join('')}
                </div>
            `).join('');
            
            // Auto-scroll to end
            container.scrollLeft = container.scrollWidth;
        }

        // Global Actions
        function fullReset() {
            if (confirm("Data á€¡á€¬á€¸á€œá€¯á€¶á€¸á€€á€­á€¯ Reset á€œá€¯á€•á€ºá€™á€œá€¬á€¸?")) {
                localStorage.clear();
                location.reload();
            }
        }

        function copyLogs() {
            if (history.length === 0) return;
            let logStr = history.map(h => `R${h.roll}S${h.stage}: ${h.val} (P:${h.pOk?'OK':'X'})`).join('\n');
            navigator.clipboard.writeText(logStr).then(() => alert("Copied to clipboard!"));
        }

        // Initialize App
        window.onload = () => {
            const saved = JSON.parse(localStorage.getItem('OMNI_V37_DB'));
            if (saved) {
                history = saved.history || [];
                roll = saved.roll || 1;
                stage = saved.stage || 1;
                renderUI();
                if (history.length > 0) {
                    updatePredictions(history[history.length - 1].val);
                    syncPHI();
                }
            }
            inputField.focus();
        };

        // Handle Keyboard Enter
        inputField.addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                event.preventDefault();
                submitDigit();
            }
        });
    </script>
</body>
</html>
